(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0542b10b"],{"06e5":function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"inner draw",on:{mousemove:function(e){return t.beginPath(e)}}},[n("div",{staticStyle:{display:"none"}},[n("img",{ref:"conf0",attrs:{src:i("3303"),width:"50",height:"50"}})]),t.f1?n("div",{staticClass:"return",on:{click:function(e){return t.gotosence()}}},[n("img",{attrs:{src:i("0ed0"),alt:""}})]):t._e(),n("canvas",{staticClass:"fl",attrs:{id:"canvas",width:t.windowWidth>t.windowHeight?t.windowWidth:t.windowHeight,height:t.windowHeight<t.windowWidth?t.windowHeight:t.windowWidth},on:{mousedown:function(e){return t.canvasDown(e)},mouseup:function(e){return t.canvasUp(e)},mousemove:function(e){return t.canvasMove(e)},touchstart:function(e){return t.canvasDown(e)},touchend:function(e){return t.canvasUp(e)},touchmove:function(e){return t.canvasMove(e)}}}),t.f1?n("div",{staticClass:"f2",attrs:{id:"control"}},[n("div",{staticClass:"canvas-color-control",attrs:{id:"canvas-color"},on:{click:function(e){return t.gotoliven()}}},[n("img",{attrs:{src:i("ec88"),alt:""}})]),n("div",{staticClass:"canvas-color-control",style:{"background-color":t.btnbgcolor},attrs:{id:"canvas-brush"},on:{click:function(e){return t.getMsg()}}},[n("div",{staticClass:"canvas-color-control-bg",style:{"background-color":t.btnbgcolor}},[n("img",{directives:[{name:"show",rawName:"v-show",value:2===t.config.lineWidth,expression:"config.lineWidth === 2"}],attrs:{src:i("6c1d"),alt:""}}),n("img",{directives:[{name:"show",rawName:"v-show",value:18===t.config.lineWidth,expression:"config.lineWidth === 18"}],attrs:{src:i("df3f"),alt:""}})])]),n("div",{staticClass:"canvas-color-control",style:{"background-color":t.btnbgcolor},attrs:{id:"canvas-color"},on:{click:function(e){return t.gotocolor()}}},[n("div",{staticClass:"canvas-color-control-bg",style:{"background-color":t.btnbgcolor}})]),n("div",{attrs:{id:"canvas-control"}},t._l(t.controls,(function(e){return n("span",{key:e.id,class:e.className,attrs:{title:e.title},on:{click:function(i){return t.controlCanvas(e.action)}}},[n("img",{attrs:{src:e.img,alt:""}})])})),0)]):t._e(),t.showpen?n("div",{staticClass:"f1",attrs:{id:"control"}},[n("div",{staticStyle:{display:"flex","flex-direction":"column"},attrs:{id:"canvas-brush"}},t._l(t.brushs,(function(e){return n("span",{key:e.id,class:[e.className,{active:t.config.lineWidth===e.lineWidth}],on:{click:function(i){return t.setBrush(e.lineWidth)}}},[n("img",{attrs:{src:e.img,alt:""}})])})),0)]):t._e(),t.showcolor?n("div",{staticClass:"f3",attrs:{id:"control"}},[n("div",{staticClass:"canvas-color-1",attrs:{id:"canvas-color"}},[n("ul",t._l(t.colors,(function(e){return n("li",{key:e.id,class:{active:t.config.lineColor===e},style:{background:e},on:{click:function(i){return t.setColor(e)}}})})),0)])]):t._e(),n("div",{directives:[{name:"show",rawName:"v-show",value:t.imgUrl.length,expression:"imgUrl.length"}],attrs:{id:"img-box"}},t._l(t.imgUrl,(function(e){return n("div",{key:e,staticClass:"img-item"},[n("img",{attrs:{src:e}}),n("span",{staticClass:"fa fa-close",on:{click:function(i){return t.removeImg(e)}}},[t._v("清空图片")])])})),0),n("div",[n("audio",{ref:"shakeAudio",attrs:{src:i("b5f6")}},[t._v(" 您的浏览器不支持 audio 标签。 ")])])])},o=[],s=i("53ca"),a=(i("4de4"),i("99af"),i("12d6")),r=a["a"].requireModule("channel"),c=a["a"].requireModule("account"),h={data:function(){return{colors:["#E05047","#E17048","#E8B559","#92D14F","#9FF3FD","#726FFE","#719939","#70CED8","#3D3BA9","#E78D8C","#E8A885","#F2D68D","#ACDBE1","#B89AE0","#FBE76A","#7AD26E","#3F9FAD","#E07BE5","#AB345E","#BE9345","#CECE5C","#49864A","#2F5F75","#8556CA"],brushs:[{className:"small fa fa-paint-brush",img:i("6c1d"),lineWidth:2},{className:"middle fa fa-paint-brush",img:i("df3f"),lineWidth:18}],context:{},imgUrl:[],show:!1,showpen:!1,showcolor:!1,f1:!0,btnbgcolor:"",btnbgbrush:"",fish:this.$route.query,windowWidth:document.documentElement.clientWidth,windowHeight:document.documentElement.clientHeight,iconBase64:"",canvasMoveUse:!1,preDrawAry:[],nextDrawAry:[],middleAry:[],config:{lineWidth:2,lineColor:"#f2849e",shadowBlur:2}}},created:function(){this.$emit("setNav","在线涂鸦画板")},watch:{},mounted:function(){var t=document.querySelector("#canvas");this.context=t.getContext("2d"),this.initDraw(),this.setCanvasStyle(),this.ImageToFXiangao()},beforeUpdate:function(){},updated:function(){},destroyed:function(){},computed:{controls:function(){return[{title:"上一步",action:"prev",img:i("be77"),className:this.preDrawAry.length?"active fa fa-reply":"fa fa-reply"},{title:"下一步",action:"next",img:i("af7e"),className:this.nextDrawAry.length?"active fa fa-share":"fa fa-share"}]}},methods:{isPc:function(){for(var t=navigator.userAgent,e=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],i=!0,n=0;n<e.length;n++)if(t.indexOf(e[n])>0){i=!1;break}return i},gotof1:function(){this.f1=!this.f1},gotosence:function(){this.$router.push({path:"/board"})},getMsg:function(){var t=this;console.log("start listen dongle msg"),r.addMsgReceiveListener({onReceive:function(e){console.log("收到消息",e),console.log("数据类型",e.content,Object(s["a"])(e.content)),"noget"===e.content?(console.log("大屏没拿到数据"),t.gotoliven()):"get"===e.content&&console.log("大屏拿到了数据")}}),r.enableTransferMessage({success:function(t){console.log("设置成功")},clientId:"com.KK",enable:"true"})},gotoliven:function(){var t=this;this.show=!this.show,this.showcolor=!1,this.showpen=!1,this.f1=!1;var e=this.CutToDoogle();c.getAccountInfo({success:function(t){var i={Use:t.data,imgUrl:e,fish:{fishId:0,fishSkill:0}},n=JSON.stringify(i);r.sendMsg({target:"com.KK",content:n,success:function(t){},fail:function(t){}})}}),this.getMsg(),setTimeout((function(){t.$router.push({path:"/game",query:{fishId:0,fishSkill:0}})}),1800)},gotopen:function(){this.showpen=!this.showpen,this.showcolor=!1},gotocolor:function(){this.showcolor=!this.showcolor,this.showpen=!1,this.getImage()},removeImg:function(t){this.imgUrl=this.imgUrl.filter((function(e){return e!==t}))},initDraw:function(){var t=this.context.getImageData(0,0,2e3,2e3);this.middleAry.push(t)},canvasMove:function(t){if(this.canvasMoveUse){var e,i,n=t.target;this.isPc()?(e=t.clientX-n.parentNode.offsetLeft,i=t.clientY-n.parentNode.offsetTop):(e=t.changedTouches[0].clientX-n.parentNode.offsetLeft,i=t.changedTouches[0].clientY-n.parentNode.offsetTop),this.context.lineTo(e,i),this.context.stroke()}},beginPath:function(t){var e=document.querySelector("#canvas");if(t.target!==e){var i=this.$refs.shakeAudio;i.play(),this.context.beginPath()}},canvasUp:function(t){var e=this.context.getImageData(0,0,2e3,2e3);this.nextDrawAry.length?(this.middleAry=[],this.middleAry=this.middleAry.concat(this.preDrawAry),this.middleAry.push(e),this.nextDrawAry=[]):this.middleAry.push(e),this.canvasMoveUse=!1,this.gotof1(),this.f1=!0,this.showpen=!1,this.showcolor=!1},canvasDown:function(t){this.canvasMoveUse=!0;var e=t.clientX-t.target.parentNode.offsetLeft,i=t.clientY-t.target.parentNode.offsetTop;this.setCanvasStyle(),this.context.beginPath(),this.context.moveTo(e,i);var n=this.context.getImageData(0,0,2e3,2e3);this.preDrawAry.push(n),this.gotof1(),this.f1=!1,this.showpen=!1,this.showcolor=!1},setColor:function(t){this.config.lineColor=t,this.btnbgcolor=t},setBrush:function(t){this.config.lineWidth=t,this.btnbgbrush=t},controlCanvas:function(t){switch(t){case"prev":if(this.preDrawAry.length){var e=this.preDrawAry.pop(),i=this.middleAry[this.preDrawAry.length+1];this.nextDrawAry.push(i),this.context.putImageData(e,0,0)}break;case"next":if(this.nextDrawAry.length){var n=this.nextDrawAry.pop(),o=this.middleAry[this.middleAry.length-this.nextDrawAry.length-2];this.preDrawAry.push(o),this.context.putImageData(n,0,0)}break;case"clear":this.context.clearRect(0,0,this.context.canvas.width,this.context.canvas.height),this.preDrawAry=[],this.nextDrawAry=[],this.middleAry=[this.middleAry[0]];break}},getImage:function(){var t=document.querySelector("#canvas"),e=t.getContext("2d"),i=this.windowWidth,n=this.windowHeight;if(n>i)var o=i*(2920/1760),s=i,a=(n-o)/2,r=(i-s)/2;else o=n*(2920/1760),s=n,a=(i-o)/2,r=(n-s)/2;for(var c=e.getImageData(a,r,o,s),h=0;h<c.data.length;h+=4)c.data[h+3]<=100&&(c.data[h]=255,c.data[h+1]=255,c.data[h+2]=255,c.data[h+3]=255);var l=t.toDataURL("image/png"),d=t.toDataURL("image/jpeg");console.log(l,d),console.log(this.context)},setCanvasStyle:function(){this.context.lineWidth=this.config.lineWidth,this.context.shadowBlur=this.config.shadowBlur,this.context.shadowColor=this.config.lineColor,this.context.strokeStyle=this.config.lineColor},ImageToTuya:function(){var t=document.querySelector("#canvas"),e=new Image;e.src=t.toDataURL("image/png");var i=t.getContext("2d"),n=this.windowHeight*(2920/1760),o=this.windowHeight;n>this.windowWidth&&(o=this.windowWidth*this.windowHeight/n,n=this.windowWidth),i.drawImage(e,0,0,n,o)},ImageToXiangao:function(){var t=document.querySelector("#canvas"),e=t.getContext("2d"),i=this.$refs.conf0,n=this.windowHeight*(2920/1760),o=this.windowHeight;n>this.windowWidth&&(o=this.windowWidth*this.windowHeight/n,n=this.windowWidth),e.drawImage(i,0,0,n,o)},CutToDoogle:function(){var t=document.querySelector("#canvas"),e=t.getContext("2d"),i=this.windowWidth,n=this.windowHeight;if(n>i)var o=i*(2920/1760),s=i,a=(n-o)/2,r=(i-s)/2;else o=n*(2920/1760),s=n,a=(i-o)/2,r=(n-s)/2;for(var c=e.getImageData(a,r,o,s),h=0;h<c.data.length;h+=4)c.data[h+3]<=100&&(c.data[h]=255,c.data[h+1]=255,c.data[h+2]=255,c.data[h+3]=255);var l=document.createElement("canvas"),d=l.getContext("2d"),u=o,g=s;l.width=u,l.height=g,d.putImageData(c,0,0,0,0,u,g);var f=l.toDataURL("image/png");return console.log(f),f},ImageToFXiangao:function(){var t=document.querySelector("#canvas"),e=t.getContext("2d"),i=this.$refs.conf0,n=this.windowWidth,o=this.windowHeight;if(o>n)var s=n*(2920/1760),a=n,r=(o-s)/2,c=(n-a)/2;else s=o*(2920/1760),a=o,r=(n-s)/2,c=(o-a)/2;i.onload=function(){e.drawImage(i,r,c,s,a)}}}},l=h,d=(i("a128"),i("2877")),u=Object(d["a"])(l,n,o,!1,null,null,null);e["default"]=u.exports},3303:function(t,e,i){t.exports=i.p+"img/shayu.88bd9530.png"},a128:function(t,e,i){"use strict";i("d1de")},d1de:function(t,e,i){}}]);
//# sourceMappingURL=chunk-0542b10b.b8f57eeb.js.map