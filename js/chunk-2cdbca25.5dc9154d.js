(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2cdbca25"],{9622:function(t,o,e){"use strict";e.r(o);var n=function(){var t=this,o=t.$createElement,n=t._self._c||o;return n("div",{staticClass:"inner draw",on:{mousemove:function(o){return t.beginPath(o)}}},[n("div",{staticStyle:{display:"none"}},[n("img",{ref:"conf0",attrs:{src:e("ca1e"),width:"50",height:"50"}})]),t.f1?n("div",{staticClass:"return",on:{click:function(o){return t.gotosence()}}},[n("img",{attrs:{src:e("0ed0"),alt:""}})]):t._e(),n("canvas",{staticClass:"fl",attrs:{id:"canvas",width:t.windowWidth>t.windowHeight?t.windowWidth:t.windowHeight,height:t.windowHeight<t.windowWidth?t.windowHeight:t.windowWidth},on:{mousedown:function(o){return t.canvasDown(o)},mouseup:function(o){return t.canvasUp(o)},mousemove:function(o){return t.canvasMove(o)},touchstart:function(o){return t.canvasDown(o)},touchend:function(o){return t.canvasUp(o)},touchmove:function(o){return t.canvasMove(o)}}}),t.f1?n("div",{staticClass:"f2",attrs:{id:"control"}},[n("div",{staticClass:"canvas-color-control",attrs:{id:"canvas-color"},on:{click:function(o){return t.gotoliven()}}},[n("img",{attrs:{src:e("ec88"),alt:""}})]),n("div",{staticClass:"canvas-color-control",style:{"background-color":t.btnbgcolor},attrs:{id:"canvas-brush"},on:{click:function(o){return t.gotopen()}}},[n("div",{staticClass:"canvas-color-control-bg",style:{"background-color":t.btnbgcolor}},[n("img",{directives:[{name:"show",rawName:"v-show",value:2===t.config.lineWidth,expression:"config.lineWidth === 2"}],attrs:{src:e("6c1d"),alt:""}}),n("img",{directives:[{name:"show",rawName:"v-show",value:18===t.config.lineWidth,expression:"config.lineWidth === 18"}],attrs:{src:e("df3f"),alt:""}})])]),n("div",{staticClass:"canvas-color-control",style:{"background-color":t.btnbgcolor},attrs:{id:"canvas-color"},on:{click:function(o){return t.gotocolor()}}},[n("div",{staticClass:"canvas-color-control-bg",style:{"background-color":t.btnbgcolor}})]),n("div",{attrs:{id:"canvas-control"}},t._l(t.controls,(function(o){return n("span",{key:o.id,class:o.className,attrs:{title:o.title},on:{click:function(e){return t.controlCanvas(o.action)}}},[n("img",{attrs:{src:o.img,alt:""}})])})),0)]):t._e(),t.showpen?n("div",{staticClass:"f1",attrs:{id:"control"}},[n("div",{staticStyle:{display:"flex","flex-direction":"column"},attrs:{id:"canvas-brush"}},t._l(t.brushs,(function(o){return n("span",{key:o.id,class:[o.className,{active:t.config.lineWidth===o.lineWidth}],on:{click:function(e){return t.setBrush(o.lineWidth)}}},[n("img",{attrs:{src:o.img,alt:""}})])})),0)]):t._e(),t.showcolor?n("div",{staticClass:"f3",attrs:{id:"control"}},[n("div",{staticClass:"canvas-color-1",attrs:{id:"canvas-color"}},[n("ul",t._l(t.colors,(function(o){return n("li",{key:o.id,class:{active:t.config.lineColor===o},style:{background:o},on:{click:function(e){return t.setColor(o)}}})})),0)])]):t._e(),n("div",{directives:[{name:"show",rawName:"v-show",value:t.imgUrl.length,expression:"imgUrl.length"}],attrs:{id:"img-box"}},t._l(t.imgUrl,(function(o){return n("div",{key:o,staticClass:"img-item"},[n("img",{attrs:{src:o}}),n("span",{staticClass:"fa fa-close",on:{click:function(e){return t.removeImg(o)}}},[t._v("清空图片")])])})),0),t.show?n("div",{staticClass:"liven"},[n("img",{attrs:{src:"https://xcx.newryun.com/media/static/graffiti/liven.png",alt:""}})]):t._e(),n("div",[n("audio",{ref:"shakeAudio",attrs:{src:e("b5f6")}},[t._v(" 您的浏览器不支持 audio 标签。 ")])])])},i=[],s=e("53ca"),a=(e("4de4"),e("99af"),e("12d6")),c=a["a"].requireModule("channel"),r=a["a"].requireModule("account"),l={data:function(){return{colors:["#E05047","#E17048","#E8B559","#92D14F","#9FF3FD","#726FFE","#719939","#70CED8","#3D3BA9","#E78D8C","#E8A885","#F2D68D","#ACDBE1","#B89AE0","#FBE76A","#7AD26E","#3F9FAD","#E07BE5","#AB345E","#BE9345","#CECE5C","#49864A","#2F5F75","#8556CA"],brushs:[{className:"small fa fa-paint-brush",img:e("6c1d"),lineWidth:2},{className:"middle fa fa-paint-brush",img:e("df3f"),lineWidth:18}],context:{},imgUrl:[],show:!1,showpen:!1,showcolor:!1,f1:!0,btnbgcolor:"",btnbgbrush:"",fish:this.$route.query,windowWidth:document.documentElement.clientWidth,windowHeight:document.documentElement.clientHeight,iconBase64:"",canvasMoveUse:!1,preDrawAry:[],nextDrawAry:[],middleAry:[],config:{lineWidth:2,lineColor:"#f2849e",shadowBlur:2}}},created:function(){this.$emit("setNav","在线涂鸦画板")},watch:{},mounted:function(){var t=document.querySelector("#canvas");this.context=t.getContext("2d"),this.initDraw(),this.setCanvasStyle(),this.ImageToFXiangao()},beforeUpdate:function(){},updated:function(){},destroyed:function(){},computed:{controls:function(){return[{title:"上一步",action:"prev",img:e("be77"),className:this.preDrawAry.length?"active fa fa-reply":"fa fa-reply"},{title:"下一步",action:"next",img:e("af7e"),className:this.nextDrawAry.length?"active fa fa-share":"fa fa-share"}]}},methods:{isPc:function(){for(var t=navigator.userAgent,o=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],e=!0,n=0;n<o.length;n++)if(t.indexOf(o[n])>0){e=!1;break}return e},gotof1:function(){this.f1=!this.f1},gotosence:function(){this.$router.push({path:"/board"})},getMsg:function(){var t=this;console.log("start listen dongle msg"),c.addMsgReceiveListener({onReceive:function(o){console.log("收到消息",o),console.log("数据类型",o.content,Object(s["a"])(o.content)),"noget"===o.content?(console.log("大屏没拿到数据"),t.gotoliven()):"get"===o.content&&console.log("大屏拿到了数据")}}),c.enableTransferMessage({success:function(t){console.log("设置成功")},clientId:"com.KK",enable:"true"})},gotoliven:function(){var t=this;this.show=!this.show,this.showcolor=!1,this.showpen=!1,this.f1=!1;var o=this.CutToDoogle();r.getAccountInfo({success:function(t){console.log(t.data);var e={Use:t.data,imgUrl:o,fish:{fishId:6,fishSkill:0}},n=JSON.stringify(e);console.log("发送参数",n),c.sendMsg({target:"com.KK",content:n,success:function(t){console.log("获取用户信息",t)},fail:function(t){console.log(t,"错误")}})}}),this.getMsg(),setTimeout((function(){t.$router.push({path:"/game",query:{fishId:6,fishSkill:0}})}),1800)},gotopen:function(){this.showpen=!this.showpen,this.showcolor=!1},gotocolor:function(){this.showcolor=!this.showcolor,this.showpen=!1},removeImg:function(t){this.imgUrl=this.imgUrl.filter((function(o){return o!==t}))},initDraw:function(){var t=this.context.getImageData(0,0,2e3,2e3);this.middleAry.push(t)},canvasMove:function(t){if(this.canvasMoveUse){console.log("canvasMove");var o,e,n=t.target;this.isPc()?(o=t.clientX-n.parentNode.offsetLeft,e=t.clientY-n.parentNode.offsetTop):(o=t.changedTouches[0].clientX-n.parentNode.offsetLeft,e=t.changedTouches[0].clientY-n.parentNode.offsetTop),this.context.lineTo(o,e),console.log(n.parentNode.offsetLeft,n.parentNode.offsetTop,o),this.context.stroke()}},beginPath:function(t){var o=document.querySelector("#canvas");if(t.target!==o){var e=this.$refs.shakeAudio;e.play(),console.log("beginPath"),this.context.beginPath()}},canvasUp:function(t){console.log("canvasUp");var o=this.context.getImageData(0,0,2e3,2e3);this.nextDrawAry.length?(this.middleAry=[],this.middleAry=this.middleAry.concat(this.preDrawAry),this.middleAry.push(o),this.nextDrawAry=[]):this.middleAry.push(o),this.canvasMoveUse=!1,this.gotof1(),this.f1=!0,this.showpen=!1,this.showcolor=!1},canvasDown:function(t){console.log("canvasDown"),this.canvasMoveUse=!0;var o=t.clientX-t.target.parentNode.offsetLeft,e=t.clientY-t.target.parentNode.offsetTop;console.log(o,e),this.setCanvasStyle(),this.context.beginPath(),this.context.moveTo(o,e),console.log("moveTo",o,e);var n=this.context.getImageData(0,0,2e3,2e3);this.preDrawAry.push(n),this.gotof1(),this.f1=!1,this.showpen=!1,this.showcolor=!1},setColor:function(t){this.config.lineColor=t,console.log(this.config.lineColor),this.btnbgcolor=t,console.log(this.btnbgcolor)},setBrush:function(t){this.config.lineWidth=t,console.log(this.config.lineWidth),this.btnbgbrush=t,console.log(this.btnbgbrush)},controlCanvas:function(t){switch(t){case"prev":if(this.preDrawAry.length){var o=this.preDrawAry.pop(),e=this.middleAry[this.preDrawAry.length+1];this.nextDrawAry.push(e),this.context.putImageData(o,0,0)}break;case"next":if(this.nextDrawAry.length){var n=this.nextDrawAry.pop(),i=this.middleAry[this.middleAry.length-this.nextDrawAry.length-2];this.preDrawAry.push(i),this.context.putImageData(n,0,0)}break;case"clear":this.context.clearRect(0,0,this.context.canvas.width,this.context.canvas.height),this.preDrawAry=[],this.nextDrawAry=[],this.middleAry=[this.middleAry[0]];break}},getImage:function(){var t=document.querySelector("#canvas"),o=t.toDataURL("image/png");this.imgUrl.push(o),this.isPc()||(window.location.href=o),console.log(this.context)},setCanvasStyle:function(){this.context.lineWidth=this.config.lineWidth,this.context.shadowBlur=this.config.shadowBlur,this.context.shadowColor=this.config.lineColor,this.context.strokeStyle=this.config.lineColor},ImageToTuya:function(){var t=document.querySelector("#canvas"),o=new Image;o.src=t.toDataURL("image/png");var e=t.getContext("2d"),n=this.windowHeight*(2920/1760),i=this.windowHeight;n>this.windowWidth&&(i=this.windowWidth*this.windowHeight/n,n=this.windowWidth),console.log(o,n,i),e.drawImage(o,0,0,n,i),console.log("涂鸦加载")},ImageToXiangao:function(){var t=document.querySelector("#canvas"),o=t.getContext("2d"),e=this.$refs.conf0,n=this.windowHeight*(2920/1760),i=this.windowHeight;n>this.windowWidth&&(i=this.windowWidth*this.windowHeight/n,n=this.windowWidth),console.log(e,n,i),o.drawImage(e,0,0,n,i),console.log("线稿加载")},CutToDoogle:function(){var t=document.querySelector("#canvas"),o=t.getContext("2d"),e=this.windowWidth,n=this.windowHeight;if(n>e)var i=e*(2920/1760),s=e,a=(n-i)/2,c=(e-s)/2;else i=n*(2920/1760),s=n,a=(e-i)/2,c=(n-s)/2;console.log(a,c,i,s);for(var r=o.getImageData(a,c,i,s),l=0;l<r.data.length;l+=4)r.data[l+3]<=100&&(r.data[l]=255,r.data[l+1]=255,r.data[l+2]=255,r.data[l+3]=255);var h=document.createElement("canvas"),d=h.getContext("2d"),g=i,u=s;h.width=g,h.height=u,d.putImageData(r,0,0,0,0,g,u);var f=h.toDataURL("image/png");return console.log(f),f},ImageToFXiangao:function(){var t=document.querySelector("#canvas"),o=t.getContext("2d"),e=this.$refs.conf0,n=this.windowWidth,i=this.windowHeight;if(i>n)var s=n*(2920/1760),a=n,c=(i-s)/2,r=(n-a)/2;else s=i*(2920/1760),a=i,c=(n-s)/2,r=(i-a)/2;console.log(e,s,a,c,r),e.onload=function(){o.drawImage(e,c,r,s,a)},console.log("第一次线稿加载")}}},h=l,d=(e("fff4"),e("2877")),g=Object(d["a"])(h,n,i,!1,null,null,null);o["default"]=g.exports},ca1e:function(t,o,e){t.exports=e.p+"img/shenxianyu.7d2f5ae5.png"},eea3:function(t,o,e){},fff4:function(t,o,e){"use strict";e("eea3")}}]);
//# sourceMappingURL=chunk-2cdbca25.5dc9154d.js.map